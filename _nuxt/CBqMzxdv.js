import{d as F,u as N,a as U,b as z,Z as H,k,o as O,p as V,$ as j,c as r,e as i,s as u,f as t,w as M,B as v,x as G,g as h,F as m,r as $,n as b,t as c,h as _,a0 as B,a1 as Z,C as q}from"./Et5F7Gb8.js";import J from"./CDRAowPI.js";import{_ as R}from"./CNnjY17f.js";import"./C4e7VoVa.js";const W={class:"essay-stats"},Y={class:"essay-more",href:"https://moment.051531.xyz",target:"_blank",rel:"noopener noreferrer"},K={class:"page-essay"},Q={class:"talk-container"},X={key:0,class:"loading-container"},tt={key:1,class:"error-container"},ot={key:2,class:"talks-list"},nt={class:"talk-meta"},et=["src","alt"],at={class:"info"},st={class:"talk-nick"},lt={class:"talk-date"},rt={class:"talk-content"},it=["innerHTML"],ct={key:0,class:"zone_imgbox"},dt={key:1,class:"video-container"},ut=["src"],vt=["src"],_t=["src"],bt=["href"],gt={class:"douban-card-left"},pt={class:"douban-card-right"},kt={class:"douban-card-item"},ht={class:"douban-card-item"},mt={class:"douban-card-item"},yt={class:"douban-card-item"},ft=["href"],wt={class:"douban-card-left"},xt={class:"douban-card-right"},Mt={class:"douban-card-item"},$t={class:"douban-card-item"},Bt={class:"douban-card-item"},Ct={class:"douban-card-item"},Tt={key:4,class:"external-link gradient-card"},St=["href"],It={class:"link-left"},Pt=["src","alt"],Lt={class:"link-right"},At={class:"link-title"},Dt={class:"talk-bottom"},Et={class:"talk-tags"},Ft={class:"tag"},Nt=["onClick"],Ut=["onClick"],zt=F({__name:"essays",setup(Ht){const C=N();U().setAside(["blog-stats","connectivity","latest-comments","blog-log"]),z({title:"Áû¨Èó¥",meta:[{property:"og:type",content:"profile"},{name:"description",content:`${C.title}ÁöÑÁ¢éÁ¢éÂøµÈ°µÈù¢ÔºåËÆ∞ÂΩïÁîüÊ¥ªÁÇπÊª¥Ôºå‰∏Ä‰∫õÊÉ≥Ê≥ïÂíåÁîüÊ¥ª„ÄÇ`}]});const y={MEMO_API:"https://avvlqyndvewl.ap-northeast-1.clawcloudrun.com/api/memo/list",PAGE_SIZE:30},d=H("essayTalks",()=>({talks:[],loading:!0,error:!1,lastFetchTime:0})),T=k(()=>d.value.talks),S=k(()=>d.value.loading),I=k(()=>d.value.error);function P(s){const o=new Date(s),e=[o.getFullYear(),o.getMonth()+1,o.getDate(),o.getHours(),o.getMinutes()].map(a=>a.toString().length===1?`0${a}`:a);return`${e[0]}-${e[1]}-${e[2]} ${e[3]}:${e[4]}`}function L(s){let o=s.content;const l=s.imgs?s.imgs.split(","):[],e=JSON.parse(s.ext||"{}");return o=o.replace(/\[(.*?)\]\((.*?)\)/g,'<a class="talk_content_link" target="_blank" rel="nofollow" href="$2">@$1</a>').replace(/- \[ \]/g,"‚ö™").replace(/- \[x\]/g,"‚ö´").replace(/\n/g,"<br>"),o=`<div class="talk_content_text">${o}</div>`,{text:o,images:l.map(a=>a.startsWith("http")?a:`https:${a}`),video:e.video?.type==="bilibili"?{type:"bilibili",url:e.video.value,id:e.video.value.match(/BV\w+/)?.[0]}:e.video?.type==="youtube"?{type:"youtube",url:e.video.value,id:e.video.value.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w-]{11})/)?.[1]}:e.video?.type==="online"?{type:"online",url:e.video.value}:null,doubanMovie:e.doubanMovie?.id?{url:e.doubanMovie.url,title:e.doubanMovie.title,image:e.doubanMovie.image,director:e.doubanMovie.director,rating:e.doubanMovie.rating,runtime:e.doubanMovie.runtime}:null,doubanBook:e.doubanBook?.id?{url:e.doubanBook.url,title:e.doubanBook.title,image:e.doubanBook.image,author:e.doubanBook.author,pubDate:e.doubanBook.pubDate,rating:e.doubanBook.rating}:null,externalLink:s.externalUrl?{url:s.externalUrl,title:s.externalTitle,favicon:s.externalFavicon}:null}}async function A(){const s=Date.now();if(!(s-d.value.lastFetchTime<1800*1e3))try{d.value.loading=!0,d.value.error=!1;const o=await fetch(y.MEMO_API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:y.PAGE_SIZE})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const l=await o.json();if(l.code===0&&l.data?.list){const e=l.data.list.map(a=>({content:L(a),user:{username:a.user.username,nickname:a.user.nickname,avatarUrl:a.user.avatarUrl},date:P(a.createdAt),location:a.location||"",tags:a.tags?typeof a.tags=="string"?a.tags.split(",").filter(g=>g.trim()):a.tags:["Êó†Ê†áÁ≠æ"]}));d.value.talks=e,d.value.lastFetchTime=s}}catch(o){console.error("Error fetching talks:",o),d.value.error=!0}finally{d.value.loading=!1}}O(A);function D(s){const o=s.replace(/<[^>]+>/g,""),l=document.querySelector(".tk-input .el-textarea__inner");l&&(l.value=`> ${o}

`,l.focus(),l.scrollIntoView({behavior:"smooth",block:"center"}))}function E(s){if(!s)return;const o=`https://www.google.com/maps/search/${encodeURIComponent(s)}`;window.open(o,"_blank")}return(s,o)=>{const l=G,e=V("PageBanner"),a=J,g=R,f=j("tip");return i(),r(m,null,[u(e,{title:"Áû¨Èó¥",subtitle:"ËÆ∞ÂΩïÁîüÊ¥ªÁÇπÊª¥Ôºå‰∏Ä‰∫õÊÉ≥Ê≥ï",image:"https://lib.bsgun.cn/Hexo-static/img/essay-bg.avif"},{extra:M(()=>[t("div",W,[o[1]||(o[1]=t("div",{class:"powered-by"},"Powered by moments",-1)),t("a",Y,[u(l,{name:"icon-park-twotone:more-app",class:"icon"}),o[0]||(o[0]=v(" Êü•ÁúãÊõ¥Â§ö ",-1))])])]),_:1}),t("div",K,[t("div",Q,[u(Z,{name:"fade",mode:"out-in"},{default:M(()=>[h(S)?(i(),r("div",X,o[2]||(o[2]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Âä†ËΩΩ‰∏≠...",-1)]))):h(I)?(i(),r("div",tt,[u(l,{name:"line-md:alert",class:"error-icon"}),o[3]||(o[3]=t("p",null,"Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï",-1))])):(i(),r("div",ot,[(i(!0),r(m,null,$(h(T),(n,w)=>(i(),r("div",{key:w,class:"talk-item",style:b({"--delay":`${w*.1}s`})},[t("div",nt,[t("img",{class:"avatar",src:n.user.avatarUrl,alt:n.user.nickname},null,8,et),t("div",at,[t("div",st,[v(c(n.user.nickname)+" ",1),u(l,{name:"material-symbols:verified",class:"verified"})]),t("div",lt,c(n.date),1)])]),t("div",rt,[t("div",{class:"talk_content_text",innerHTML:n.content.text},null,8,it),n.content.images.length?(i(),r("div",ct,[(i(!0),r(m,null,$(n.content.images,(p,x)=>(i(),r("figure",{key:x,class:"img-item"},[u(a,{src:p,zoom:"",class:"talk-img",loading:"lazy",fetchpriority:x===0?"high":"low"},null,8,["src","fetchpriority"])]))),128))])):_("",!0),n.content.video?(i(),r("div",dt,[n.content.video.type==="bilibili"?(i(),r("iframe",{key:0,src:`//player.bilibili.com/player.html?bvid=${n.content.video.id}&autoplay=0`,scrolling:"no",frameborder:"no",allowfullscreen:"true"},null,8,ut)):n.content.video.type==="youtube"?(i(),r("iframe",{key:1,src:`https://www.youtube.com/embed/${n.content.video.id}`,frameborder:"0",allowfullscreen:""},null,8,vt)):n.content.video.type==="online"?(i(),r("video",{key:2,src:n.content.video.url,controls:"",class:"online-video"},null,8,_t)):_("",!0)])):_("",!0),n.content.doubanMovie?(i(),r("a",{key:2,class:"douban-card gradient-card",href:n.content.doubanMovie.url,target:"_blank"},[t("div",{class:"douban-card-bgimg",style:b({backgroundImage:`url('${n.content.doubanMovie.image}')`})},null,4),t("div",gt,[t("div",{class:"douban-card-img",style:b({backgroundImage:`url('${n.content.doubanMovie.image}')`})},null,4)]),t("div",pt,[t("div",kt,[o[4]||(o[4]=t("span",null,"ÁîµÂΩ±Âêç: ",-1)),t("strong",null,c(n.content.doubanMovie.title),1)]),t("div",ht,[o[5]||(o[5]=t("span",null,"ÂØºÊºî: ",-1)),v(" "+c(n.content.doubanMovie.director),1)]),t("div",mt,[o[6]||(o[6]=t("span",null,"ËØÑÂàÜ: ",-1)),v(" "+c(n.content.doubanMovie.rating),1)]),t("div",yt,[o[7]||(o[7]=t("span",null,"Êó∂Èïø: ",-1)),v(" "+c(n.content.doubanMovie.runtime),1)])])],8,bt)):_("",!0),n.content.doubanBook?(i(),r("a",{key:3,class:"douban-card gradient-card",href:n.content.doubanBook.url,target:"_blank"},[t("div",{class:"douban-card-bgimg",style:b({backgroundImage:`url('${n.content.doubanBook.image}')`})},null,4),t("div",wt,[t("div",{class:"douban-card-img",style:b({backgroundImage:`url('${n.content.doubanBook.image}')`})},null,4)]),t("div",xt,[t("div",Mt,[o[8]||(o[8]=t("span",null,"‰π¶Âêç: ",-1)),t("strong",null,c(n.content.doubanBook.title),1)]),t("div",$t,[o[9]||(o[9]=t("span",null,"‰ΩúËÄÖ: ",-1)),v(" "+c(n.content.doubanBook.author),1)]),t("div",Bt,[o[10]||(o[10]=t("span",null,"Âá∫ÁâàÂπ¥‰ªΩ: ",-1)),v(" "+c(n.content.doubanBook.pubDate),1)]),t("div",Ct,[o[11]||(o[11]=t("span",null,"ËØÑÂàÜ: ",-1)),v(" "+c(n.content.doubanBook.rating),1)])])],8,ft)):_("",!0),n.content.externalLink?(i(),r("div",Tt,[t("a",{href:n.content.externalLink.url,target:"_blank",rel:"nofollow"},[t("div",It,[t("img",{src:n.content.externalLink.favicon,alt:n.content.externalLink.title},null,8,Pt)]),t("div",Lt,[t("div",At,c(n.content.externalLink.title),1),u(l,{name:"material-symbols:chevron-right",class:"icon"})])],8,St)])):_("",!0)]),t("div",Dt,[t("div",Et,[t("span",Ft," üè∑Ô∏è"+c(Array.isArray(n.tags)?n.tags.join(", "):n.tags),1),n.location?B((i(),r("span",{key:0,class:"location",onClick:p=>E(n.location)},[u(l,{name:"ph:map-pin-bold",class:"location-icon"}),v(" "+c(n.location),1)],8,Nt)),[[f,`ÊêúÁ¥¢: ${n.location}`]]):_("",!0)]),B((i(),r("button",{class:"comment-btn",onClick:p=>D(n.content.text)},[u(l,{name:"ph:chats-bold",class:"icon"})],8,Ut)),[[f,"ËØÑËÆ∫"]])])],4))),128)),o[12]||(o[12]=t("div",{class:"talks-footer"},[t("p",null,"‰ªÖÊòæÁ§∫ÊúÄËøë 30 Êù°ËÆ∞ÂΩï")],-1))]))]),_:1})])]),u(g,{key:"/essay"})],64)}}}),qt=q(zt,[["__scopeId","data-v-8f7be800"]]);export{qt as default};
