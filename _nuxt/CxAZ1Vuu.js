import{r as C,aH as D,ac as g,ap as A,aI as q,aJ as B,d as E,O as F,aK as S,a2 as V,c as z,q as T,o as p,a0 as b,C as m,L as H,G as k,H as I,K as N,u as h,a as w,D as P,F as O,a5 as R,_ as $}from"./5CQT5J33.js";import{u as G}from"./_crlFDoM.js";import{q as K}from"./Dyyc3vux.js";import"./IShi1APO.js";import"./980N5lj0.js";const J=({delay:o},e)=>{let t,s=!0;const n=(...c)=>{s?(clearTimeout(t),t=setTimeout(()=>{s&&e(...c),t=void 0},o)):e(...c)};return n.isPending=()=>t!==void 0,n.cancel=()=>{s=!1},n.flush=(...c)=>e(...c),n},L=({interval:o},e)=>{let t=!0,s;const n=(...c)=>{t&&(e(...c),t=!1,s=setTimeout(()=>{t=!0,s=void 0},o))};return n.isThrottled=()=>s!==void 0,n},M=o=>L({interval:20},o),U=o=>J({delay:20},o);function W(o){const e=M(o),t=U(o);return()=>{e(),t()}}function Y(o){const e=C(null),t=(f,i=[])=>(f.forEach(l=>{const u=document.getElementById(l.id);u&&i.push({id:l.id,offsetTop:u.offsetTop}),l.children&&t(l.children,i)}),i),s=D(()=>g(o),()=>t(g(o)).reverse()),n=()=>{const f=Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("scroll-margin-top")),i=window.scrollY+(f||64),l=s.value.find(r=>r.offsetTop<=i);e.value=(l==null?void 0:l.id)||null;const u=document.querySelector("#z-aside"),a=document.querySelector(`#z-aside a[href="#${e.value}"]`);u==null||u.scroll({top:(a==null?void 0:a.offsetTop)||0})};A("scroll",W(()=>n()),{passive:!0});const{height:c}=q(document==null?void 0:document.body);return B(c,s.trigger),{activeTocItem:e}}const j=["href","title"],Q={class:"widget-title"},X={href:"#main-content","aria-label":"返回开头"},Z={href:"#twikoo","aria-label":"评论区"},ee={class:"widget-body"},te={key:1,class:"no-toc"},oe=E({__name:"Toc",async setup(o){let e,t;const s=F(),[n,c]=S(),{data:f}=([e,t]=V(()=>G(s.path,()=>K(s.path).findOne(),"$GTbUemPlen")),e=await e,t(),e),i=z(()=>{var a,r;return(r=(a=f.value)==null?void 0:a.body)==null?void 0:r.toc}),{activeTocItem:l}=Y(()=>{var a;return((a=i.value)==null?void 0:a.links)??[]});function u(a,r){var _;return a.id===r?!0:((_=a.children)==null?void 0:_.some(v=>u(v,r)))??!1}return(a,r)=>{var v;const _=R;return p(),T(k,null,[b(h(n),null,{default:H(({tocItem:x})=>[m("ol",null,[(p(!0),T(k,null,I(x,(d,y)=>(p(),T("li",{key:y,class:N({"has-active":u(d,h(l)),active:d.id===h(l)})},[m("a",{href:`#${d==null?void 0:d.id}`,title:d.text},O(d.text),9,j),d.children?(p(),w(h(c),{key:0,"toc-item":d.children},null,8,["toc-item"])):P("",!0)],2))),128))])]),_:1}),m("h3",Q,[r[0]||(r[0]=m("span",{class:"title"},"文章目录",-1)),m("a",X,[b(_,{name:"ph:arrow-circle-up-bold"})]),m("a",Z,[b(_,{name:"ph:chat-circle-text-bold"})])]),m("div",ee,[(v=h(i))!=null&&v.links.length?(p(),w(h(c),{key:0,"toc-item":h(i).links},null,8,["toc-item"])):(p(),T("p",te," 暂无目录信息 "))])],64)}}}),re=$(oe,[["__scopeId","data-v-4ff50781"]]);export{re as default};
