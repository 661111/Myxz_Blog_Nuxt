var zt=Object.defineProperty;var Mt=(n,t,e)=>t in n?zt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var O=(n,t,e)=>Mt(n,typeof t!="symbol"?t+"":t,e);import{c as k,ad as z,G as kt,aM as Ct,d as gt,aN as rt,a as W,o as M,N as F,x as N,I as A,u as w,A as C,a5 as Ft,_ as _t,p as Tt,D as Ot,aO as Lt,r as at,w as U,R as Vt,aP as Et,ap as At,aK as Dt,q as E,a1 as L,aA as ct,J as q,M as $t,K as Rt,a6 as Nt,aQ as ut,a4 as jt,aR as Pt,T as Wt,F as Jt,y as Ut,O as qt}from"./2hZIork9.js";import Bt from"./ChUCBECz.js";import Qt from"./CjCgzvaE.js";import{u as Kt,a as Ht}from"./BR5ShXfB.js";import{h as Gt}from"./IShi1APO.js";import"./1NOX4i_a.js";function dt(n,t,e){const[s={},i]=typeof t=="string"?[{},t]:[t,e],o=k(()=>z(n)),a=s.key||Gt([i,typeof o.value=="string"?o.value:"",...Zt(s)]);if(!a||typeof a!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+a);if(!n)throw new Error("[nuxt] [useFetch] request is missing.");const r=a===i?"$f"+a:a;if(!s.baseURL&&typeof o.value=="string"&&o.value[0]==="/"&&o.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:u,lazy:d,default:l,transform:m,pick:h,watch:g,immediate:f,getCachedData:c,deep:_,dedupe:v,...p}=s,x=kt({...Ct,...p,cache:typeof s.cache=="boolean"?void 0:s.cache}),T={server:u,lazy:d,default:l,transform:m,pick:h,immediate:f,getCachedData:c,deep:_,dedupe:v,watch:g===!1?[]:[x,o,...g||[]]};let y;return Kt(r,()=>{var ot;(ot=y==null?void 0:y.abort)==null||ot.call(y,"Request aborted as another request to the same endpoint was initiated."),y=typeof AbortController<"u"?new AbortController:{};const I=z(s.timeout);let R;return I&&(R=setTimeout(()=>y.abort("Request aborted due to timeout."),I),y.signal.onabort=()=>clearTimeout(R)),(s.$fetch||globalThis.$fetch)(o.value,{signal:y.signal,...x}).finally(()=>{clearTimeout(R)})},T)}function Zt(n){var e;const t=[((e=z(n.method))==null?void 0:e.toUpperCase())||"GET",z(n.baseURL)];for(const s of[n.params||n.query]){const i=z(s);if(!i)continue;const o={};for(const[a,r]of Object.entries(i))o[z(a)]=z(r);t.push(o)}return t}function Yt(n,t){try{return t in n}catch{return!1}}class Y extends Error{constructor(e,s={}){super(e,s);O(this,"statusCode",500);O(this,"fatal",!1);O(this,"unhandled",!1);O(this,"statusMessage");O(this,"data");O(this,"cause");s.cause&&!this.cause&&(this.cause=s.cause)}toJSON(){const e={message:this.message,statusCode:X(this.statusCode,500)};return this.statusMessage&&(e.statusMessage=pt(this.statusMessage)),this.data!==void 0&&(e.data=this.data),e}}O(Y,"__h3_error__",!0);function B(n){if(typeof n=="string")return new Y(n);if(Xt(n))return n;const t=new Y(n.message??n.statusMessage??"",{cause:n.cause||n});if(Yt(n,"stack"))try{Object.defineProperty(t,"stack",{get(){return n.stack}})}catch{try{t.stack=n.stack}catch{}}if(n.data&&(t.data=n.data),n.statusCode?t.statusCode=X(n.statusCode,t.statusCode):n.status&&(t.statusCode=X(n.status,t.statusCode)),n.statusMessage?t.statusMessage=n.statusMessage:n.statusText&&(t.statusMessage=n.statusText),t.statusMessage){const e=t.statusMessage;pt(t.statusMessage)!==e&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return n.fatal!==void 0&&(t.fatal=n.fatal),n.unhandled!==void 0&&(t.unhandled=n.unhandled),t}function Xt(n){var t;return((t=n==null?void 0:n.constructor)==null?void 0:t.__h3_error__)===!0}const te=/[^\u0009\u0020-\u007E]/g;function pt(n=""){return n.replace(te,"")}function X(n,t=200){return!n||(typeof n=="string"&&(n=Number.parseInt(n,10)),n<100||n>999)?t:n}const ee=["innerHTML"],se=["innerHTML"],ne=gt({__name:"SearchItem",props:{title:{},content:{},titles:{},id:{},terms:{},queryTerms:{},score:{},match:{}},setup(n){const t=n,e=k(()=>[...t.titles??[],t.title].join(" > ")),s=k(()=>{var r;return(r=t.titles)==null?void 0:r.length}),i=k(()=>{var r;return((r=t.queryTerms)==null?void 0:r[0])??""}),o=k(()=>rt(e.value,i.value)),a=k(()=>rt(t.content??"",i.value));return(r,u)=>{const d=Bt,l=Ft;return M(),W(l,{to:r.id,class:"search-item"},{default:F(()=>[N("h2",null,[w(s)?A("",!0):(M(),W(d,{key:0,round:""},{default:F(()=>u[0]||(u[0]=[C(" 文章 ")])),_:1})),N("span",{innerHTML:w(o)},null,8,ee)]),N("p",{class:"content",innerHTML:w(a)},null,8,se)]),_:1},8,["to"])}}}),ie=_t(ne,[["__scopeId","data-v-3622524a"]]),oe="ENTRIES",wt="KEYS",vt="VALUES",S="";class Q{constructor(t,e){const s=t._tree,i=Array.from(s.keys());this.set=t,this._type=e,this._path=i.length>0?[{node:s,keys:i}]:[]}next(){const t=this.dive();return this.backtrack(),t}dive(){if(this._path.length===0)return{done:!0,value:void 0};const{node:t,keys:e}=$(this._path);if($(e)===S)return{done:!1,value:this.result()};const s=t.get($(e));return this._path.push({node:s,keys:Array.from(s.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;const t=$(this._path).keys;t.pop(),!(t.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:t})=>$(t)).filter(t=>t!==S).join("")}value(){return $(this._path).node.get(S)}result(){switch(this._type){case vt:return this.value();case wt:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}}const $=n=>n[n.length-1],re=(n,t,e)=>{const s=new Map;if(t===void 0)return s;const i=t.length+1,o=i+e,a=new Uint8Array(o*i).fill(e+1);for(let r=0;r<i;++r)a[r]=r;for(let r=1;r<o;++r)a[r*i]=r;return yt(n,t,e,s,a,1,i,""),s},yt=(n,t,e,s,i,o,a,r)=>{const u=o*a;t:for(const d of n.keys())if(d===S){const l=i[u-1];l<=e&&s.set(r,[n.get(d),l])}else{let l=o;for(let m=0;m<d.length;++m,++l){const h=d[m],g=a*l,f=g-a;let c=i[g];const _=Math.max(0,l-e-1),v=Math.min(a-1,l+e);for(let p=_;p<v;++p){const x=h!==t[p],T=i[f+p]+ +x,y=i[f+p+1]+1,b=i[g+p]+1,I=i[g+p+1]=Math.min(T,y,b);I<c&&(c=I)}if(c>e)continue t}yt(n.get(d),t,e,s,i,l,a,r+d)}};class V{constructor(t=new Map,e=""){this._size=void 0,this._tree=t,this._prefix=e}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");const[e,s]=J(this._tree,t.slice(this._prefix.length));if(e===void 0){const[i,o]=nt(s);for(const a of i.keys())if(a!==S&&a.startsWith(o)){const r=new Map;return r.set(a.slice(o.length),i.get(a)),new V(r,t)}}return new V(e,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,ae(this._tree,t)}entries(){return new Q(this,oe)}forEach(t){for(const[e,s]of this)t(e,s,this)}fuzzyGet(t,e){return re(this._tree,t,e)}get(t){const e=tt(this._tree,t);return e!==void 0?e.get(S):void 0}has(t){const e=tt(this._tree,t);return e!==void 0&&e.has(S)}keys(){return new Q(this,wt)}set(t,e){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,K(this._tree,t).set(S,e),this}get size(){if(this._size)return this._size;this._size=0;const t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const s=K(this._tree,t);return s.set(S,e(s.get(S))),this}fetch(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const s=K(this._tree,t);let i=s.get(S);return i===void 0&&s.set(S,i=e()),i}values(){return new Q(this,vt)}[Symbol.iterator](){return this.entries()}static from(t){const e=new V;for(const[s,i]of t)e.set(s,i);return e}static fromObject(t){return V.from(Object.entries(t))}}const J=(n,t,e=[])=>{if(t.length===0||n==null)return[n,e];for(const s of n.keys())if(s!==S&&t.startsWith(s))return e.push([n,s]),J(n.get(s),t.slice(s.length),e);return e.push([n,t]),J(void 0,"",e)},tt=(n,t)=>{if(t.length===0||n==null)return n;for(const e of n.keys())if(e!==S&&t.startsWith(e))return tt(n.get(e),t.slice(e.length))},K=(n,t)=>{const e=t.length;t:for(let s=0;n&&s<e;){for(const o of n.keys())if(o!==S&&t[s]===o[0]){const a=Math.min(e-s,o.length);let r=1;for(;r<a&&t[s+r]===o[r];)++r;const u=n.get(o);if(r===o.length)n=u;else{const d=new Map;d.set(o.slice(r),u),n.set(t.slice(s,s+r),d),n.delete(o),n=d}s+=r;continue t}const i=new Map;return n.set(t.slice(s),i),i}return n},ae=(n,t)=>{const[e,s]=J(n,t);if(e!==void 0){if(e.delete(S),e.size===0)St(s);else if(e.size===1){const[i,o]=e.entries().next().value;bt(s,i,o)}}},St=n=>{if(n.length===0)return;const[t,e]=nt(n);if(t.delete(e),t.size===0)St(n.slice(0,-1));else if(t.size===1){const[s,i]=t.entries().next().value;s!==S&&bt(n.slice(0,-1),s,i)}},bt=(n,t,e)=>{if(n.length===0)return;const[s,i]=nt(n);s.set(i+t,e),s.delete(i)},nt=n=>n[n.length-1],it="or",It="and",ce="and_not";class D{constructor(t){if((t==null?void 0:t.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');const e=t.autoVacuum==null||t.autoVacuum===!0?Z:t.autoVacuum;this._options={...G,...t,autoVacuum:e,searchOptions:{...lt,...t.searchOptions||{}},autoSuggestOptions:{...fe,...t.autoSuggestOptions||{}}},this._index=new V,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=st,this.addFields(this._options.fields)}add(t){const{extractField:e,tokenize:s,processTerm:i,fields:o,idField:a}=this._options,r=e(t,a);if(r==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);if(this._idToShortId.has(r))throw new Error(`MiniSearch: duplicate ID ${r}`);const u=this.addDocumentId(r);this.saveStoredFields(u,t);for(const d of o){const l=e(t,d);if(l==null)continue;const m=s(l.toString(),d),h=this._fieldIds[d],g=new Set(m).size;this.addFieldLength(u,h,this._documentCount-1,g);for(const f of m){const c=i(f,d);if(Array.isArray(c))for(const _ of c)this.addTerm(h,u,_);else c&&this.addTerm(h,u,c)}}}addAll(t){for(const e of t)this.add(e)}addAllAsync(t,e={}){const{chunkSize:s=10}=e,i={chunk:[],promise:Promise.resolve()},{chunk:o,promise:a}=t.reduce(({chunk:r,promise:u},d,l)=>(r.push(d),(l+1)%s===0?{chunk:[],promise:u.then(()=>new Promise(m=>setTimeout(m,0))).then(()=>this.addAll(r))}:{chunk:r,promise:u}),i);return a.then(()=>this.addAll(o))}remove(t){const{tokenize:e,processTerm:s,extractField:i,fields:o,idField:a}=this._options,r=i(t,a);if(r==null)throw new Error(`MiniSearch: document does not have ID field "${a}"`);const u=this._idToShortId.get(r);if(u==null)throw new Error(`MiniSearch: cannot remove document with ID ${r}: it is not in the index`);for(const d of o){const l=i(t,d);if(l==null)continue;const m=e(l.toString(),d),h=this._fieldIds[d],g=new Set(m).size;this.removeFieldLength(u,h,this._documentCount,g);for(const f of m){const c=s(f,d);if(Array.isArray(c))for(const _ of c)this.removeTerm(h,u,_);else c&&this.removeTerm(h,u,c)}}this._storedFields.delete(u),this._documentIds.delete(u),this._idToShortId.delete(r),this._fieldLength.delete(u),this._documentCount-=1}removeAll(t){if(t)for(const e of t)this.remove(e);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new V,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){const e=this._idToShortId.get(t);if(e==null)throw new Error(`MiniSearch: cannot discard document with ID ${t}: it is not in the index`);this._idToShortId.delete(t),this._documentIds.delete(e),this._storedFields.delete(e),(this._fieldLength.get(e)||[]).forEach((s,i)=>{this.removeFieldLength(e,i,this._documentCount,s)}),this._fieldLength.delete(e),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;const{minDirtFactor:t,minDirtCount:e,batchSize:s,batchWait:i}=this._options.autoVacuum;this.conditionalVacuum({batchSize:s,batchWait:i},{minDirtCount:e,minDirtFactor:t})}discardAll(t){const e=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(const s of t)this.discard(s)}finally{this._options.autoVacuum=e}this.maybeAutoVacuum()}replace(t){const{idField:e,extractField:s}=this._options,i=s(t,e);this.discard(i),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,e){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&e,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{const s=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=st,this.performVacuuming(t,s)}),this._enqueuedVacuum)):this.vacuumConditionsMet(e)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}async performVacuuming(t,e){const s=this._dirtCount;if(this.vacuumConditionsMet(e)){const i=t.batchSize||et.batchSize,o=t.batchWait||et.batchWait;let a=1;for(const[r,u]of this._index){for(const[d,l]of u)for(const[m]of l)this._documentIds.has(m)||(l.size<=1?u.delete(d):l.delete(m));this._index.get(r).size===0&&this._index.delete(r),a%i===0&&await new Promise(d=>setTimeout(d,o)),a+=1}this._dirtCount-=s}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:e,minDirtFactor:s}=t;return e=e||Z.minDirtCount,s=s||Z.minDirtFactor,this.dirtCount>=e&&this.dirtFactor>=s}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){const e=this._idToShortId.get(t);if(e!=null)return this._storedFields.get(e)}search(t,e={}){const{searchOptions:s}=this._options,i={...s,...e},o=this.executeQuery(t,e),a=[];for(const[r,{score:u,terms:d,match:l}]of o){const m=d.length||1,h={id:this._documentIds.get(r),score:u*m,terms:Object.keys(l),queryTerms:d,match:l};Object.assign(h,this._storedFields.get(r)),(i.filter==null||i.filter(h))&&a.push(h)}return t===D.wildcard&&i.boostDocument==null||a.sort(ft),a}autoSuggest(t,e={}){e={...this._options.autoSuggestOptions,...e};const s=new Map;for(const{score:o,terms:a}of this.search(t,e)){const r=a.join(" "),u=s.get(r);u!=null?(u.score+=o,u.count+=1):s.set(r,{score:o,terms:a,count:1})}const i=[];for(const[o,{score:a,terms:r,count:u}]of s)i.push({suggestion:o,terms:r,score:a/u});return i.sort(ft),i}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,e){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),e)}static async loadJSONAsync(t,e){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),e)}static getDefault(t){if(G.hasOwnProperty(t))return H(G,t);throw new Error(`MiniSearch: unknown option "${t}"`)}static loadJS(t,e){const{index:s,documentIds:i,fieldLength:o,storedFields:a,serializationVersion:r}=t,u=this.instantiateMiniSearch(t,e);u._documentIds=j(i),u._fieldLength=j(o),u._storedFields=j(a);for(const[d,l]of u._documentIds)u._idToShortId.set(l,d);for(const[d,l]of s){const m=new Map;for(const h of Object.keys(l)){let g=l[h];r===1&&(g=g.ds),m.set(parseInt(h,10),j(g))}u._index.set(d,m)}return u}static async loadJSAsync(t,e){const{index:s,documentIds:i,fieldLength:o,storedFields:a,serializationVersion:r}=t,u=this.instantiateMiniSearch(t,e);u._documentIds=await P(i),u._fieldLength=await P(o),u._storedFields=await P(a);for(const[l,m]of u._documentIds)u._idToShortId.set(m,l);let d=0;for(const[l,m]of s){const h=new Map;for(const g of Object.keys(m)){let f=m[g];r===1&&(f=f.ds),h.set(parseInt(g,10),await P(f))}++d%1e3===0&&await xt(0),u._index.set(l,h)}return u}static instantiateMiniSearch(t,e){const{documentCount:s,nextId:i,fieldIds:o,averageFieldLength:a,dirtCount:r,serializationVersion:u}=t;if(u!==1&&u!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");const d=new D(e);return d._documentCount=s,d._nextId=i,d._idToShortId=new Map,d._fieldIds=o,d._avgFieldLength=a,d._dirtCount=r||0,d._index=new V,d}executeQuery(t,e={}){if(t===D.wildcard)return this.executeWildcardQuery(e);if(typeof t!="string"){const h={...e,...t,queries:void 0},g=t.queries.map(f=>this.executeQuery(f,h));return this.combineResults(g,h.combineWith)}const{tokenize:s,processTerm:i,searchOptions:o}=this._options,a={tokenize:s,processTerm:i,...o,...e},{tokenize:r,processTerm:u}=a,m=r(t).flatMap(h=>u(h)).filter(h=>!!h).map(he(a)).map(h=>this.executeQuerySpec(h,a));return this.combineResults(m,a.combineWith)}executeQuerySpec(t,e){const s={...this._options.searchOptions,...e},i=(s.fields||this._options.fields).reduce((c,_)=>({...c,[_]:H(s.boost,_)||1}),{}),{boostDocument:o,weights:a,maxFuzzy:r,bm25:u}=s,{fuzzy:d,prefix:l}={...lt.weights,...a},m=this._index.get(t.term),h=this.termResults(t.term,t.term,1,t.termBoost,m,i,o,u);let g,f;if(t.prefix&&(g=this._index.atPrefix(t.term)),t.fuzzy){const c=t.fuzzy===!0?.2:t.fuzzy,_=c<1?Math.min(r,Math.round(t.term.length*c)):c;_&&(f=this._index.fuzzyGet(t.term,_))}if(g)for(const[c,_]of g){const v=c.length-t.term.length;if(!v)continue;f==null||f.delete(c);const p=l*c.length/(c.length+.3*v);this.termResults(t.term,c,p,t.termBoost,_,i,o,u,h)}if(f)for(const c of f.keys()){const[_,v]=f.get(c);if(!v)continue;const p=d*c.length/(c.length+v);this.termResults(t.term,c,p,t.termBoost,_,i,o,u,h)}return h}executeWildcardQuery(t){const e=new Map,s={...this._options.searchOptions,...t};for(const[i,o]of this._documentIds){const a=s.boostDocument?s.boostDocument(o,"",this._storedFields.get(i)):1;e.set(i,{score:a,terms:[],match:{}})}return e}combineResults(t,e=it){if(t.length===0)return new Map;const s=e.toLowerCase(),i=ue[s];if(!i)throw new Error(`Invalid combination operator: ${e}`);return t.reduce(i)||new Map}toJSON(){const t=[];for(const[e,s]of this._index){const i={};for(const[o,a]of s)i[o]=Object.fromEntries(a);t.push([e,i])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,e,s,i,o,a,r,u,d=new Map){if(o==null)return d;for(const l of Object.keys(a)){const m=a[l],h=this._fieldIds[l],g=o.get(h);if(g==null)continue;let f=g.size;const c=this._avgFieldLength[h];for(const _ of g.keys()){if(!this._documentIds.has(_)){this.removeTerm(h,_,e),f-=1;continue}const v=r?r(this._documentIds.get(_),e,this._storedFields.get(_)):1;if(!v)continue;const p=g.get(_),x=this._fieldLength.get(_)[h],T=le(p,f,this._documentCount,x,c,u),y=s*i*m*v*T,b=d.get(_);if(b){b.score+=y,me(b.terms,t);const I=H(b.match,e);I?I.push(l):b.match[e]=[l]}else d.set(_,{score:y,terms:[t],match:{[e]:[l]}})}}return d}addTerm(t,e,s){const i=this._index.fetch(s,mt);let o=i.get(t);if(o==null)o=new Map,o.set(e,1),i.set(t,o);else{const a=o.get(e);o.set(e,(a||0)+1)}}removeTerm(t,e,s){if(!this._index.has(s)){this.warnDocumentChanged(e,t,s);return}const i=this._index.fetch(s,mt),o=i.get(t);o==null||o.get(e)==null?this.warnDocumentChanged(e,t,s):o.get(e)<=1?o.size<=1?i.delete(t):o.delete(e):o.set(e,o.get(e)-1),this._index.get(s).size===0&&this._index.delete(s)}warnDocumentChanged(t,e,s){for(const i of Object.keys(this._fieldIds))if(this._fieldIds[i]===e){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(t)} has changed before removal: term "${s}" was not present in field "${i}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(t){const e=this._nextId;return this._idToShortId.set(t,e),this._documentIds.set(e,t),this._documentCount+=1,this._nextId+=1,e}addFields(t){for(let e=0;e<t.length;e++)this._fieldIds[t[e]]=e}addFieldLength(t,e,s,i){let o=this._fieldLength.get(t);o==null&&this._fieldLength.set(t,o=[]),o[e]=i;const r=(this._avgFieldLength[e]||0)*s+i;this._avgFieldLength[e]=r/(s+1)}removeFieldLength(t,e,s,i){if(s===1){this._avgFieldLength[e]=0;return}const o=this._avgFieldLength[e]*s-i;this._avgFieldLength[e]=o/(s-1)}saveStoredFields(t,e){const{storeFields:s,extractField:i}=this._options;if(s==null||s.length===0)return;let o=this._storedFields.get(t);o==null&&this._storedFields.set(t,o={});for(const a of s){const r=i(e,a);r!==void 0&&(o[a]=r)}}}D.wildcard=Symbol("*");const H=(n,t)=>Object.prototype.hasOwnProperty.call(n,t)?n[t]:void 0,ue={[it]:(n,t)=>{for(const e of t.keys()){const s=n.get(e);if(s==null)n.set(e,t.get(e));else{const{score:i,terms:o,match:a}=t.get(e);s.score=s.score+i,s.match=Object.assign(s.match,a),ht(s.terms,o)}}return n},[It]:(n,t)=>{const e=new Map;for(const s of t.keys()){const i=n.get(s);if(i==null)continue;const{score:o,terms:a,match:r}=t.get(s);ht(i.terms,a),e.set(s,{score:i.score+o,terms:i.terms,match:Object.assign(i.match,r)})}return e},[ce]:(n,t)=>{for(const e of t.keys())n.delete(e);return n}},de={k:1.2,b:.7,d:.5},le=(n,t,e,s,i,o)=>{const{k:a,b:r,d:u}=o;return Math.log(1+(e-t+.5)/(t+.5))*(u+n*(a+1)/(n+a*(1-r+r*s/i)))},he=n=>(t,e,s)=>{const i=typeof n.fuzzy=="function"?n.fuzzy(t,e,s):n.fuzzy||!1,o=typeof n.prefix=="function"?n.prefix(t,e,s):n.prefix===!0,a=typeof n.boostTerm=="function"?n.boostTerm(t,e,s):1;return{term:t,fuzzy:i,prefix:o,termBoost:a}},G={idField:"id",extractField:(n,t)=>n[t],tokenize:n=>n.split(ge),processTerm:n=>n.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(n,t)=>{typeof(console==null?void 0:console[n])=="function"&&console[n](t)},autoVacuum:!0},lt={combineWith:it,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:de},fe={combineWith:It,prefix:(n,t,e)=>t===e.length-1},et={batchSize:1e3,batchWait:10},st={minDirtFactor:.1,minDirtCount:20},Z={...et,...st},me=(n,t)=>{n.includes(t)||n.push(t)},ht=(n,t)=>{for(const e of t)n.includes(e)||n.push(e)},ft=({score:n},{score:t})=>t-n,mt=()=>new Map,j=n=>{const t=new Map;for(const e of Object.keys(n))t.set(parseInt(e,10),n[e]);return t},P=async n=>{const t=new Map;let e=0;for(const s of Object.keys(n))t.set(parseInt(s,10),n[s]),++e%1e3===0&&await xt(0);return t},xt=n=>new Promise(t=>setTimeout(t,n)),ge=/[\n\r\p{Z}\p{P}]+/u,_e=async(n,t={})=>{const e=Tt(),{content:s}=e.public,{integrity:i,api:{baseURL:o},search:a}=s,{indexed:r}=a||{},u=`${o}/search${i?"-"+i:""}`;if(r){const{options:m}=a||{},{data:h}=await dt(u,{responseType:"text"},"$CqNQcdR4TA");if(!h.value)throw B({statusCode:500,message:"Missing search data"});return pe(n,h,m)}if(!t.miniSearch)throw B({statusCode:500,message:"Missing miniSearch options"});const{data:d}=await dt(u,"$z1h5VkIQQp");if(!d.value)throw B({statusCode:500,message:"Missing search data"});return we(n,d,t.miniSearch)},pe=(n,t,e)=>{const s=k(()=>D.loadJSON(z(t),z(e)));return k(()=>s.value.search(z(n)))},we=function(n,t,e){const s=k(()=>new D(z(e)));return s.value.addAll(z(t)),k(()=>s.value.search(z(n)))},ve={class:"z-search"},ye={key:0,id:"z-search"},Se={key:0,class:"no-result"},be={key:1,ref:"list-result",class:"scrollcheck-y search-result"},Ie=gt({__name:"Search",props:{isOpening:{type:Boolean}},setup(n){const t=n,e=Ot(),s=Lt(),i=at();U(()=>t.isOpening,async f=>{var c;await Vt(),f&&((c=i.value)==null||c.select())});const{word:o,result:a}=Et(s),r=at(0),u=At("list-result"),{data:d,execute:l,status:m}=Ht(o.value,()=>_e(o.value),{immediate:!1,transform:f=>f.value});Dt(o,()=>{r.value=0,o.value&&l()},{debounce:300}),U(()=>d.value,f=>{a.value=f}),U(r,(f,c)=>{var _,v;(_=a.value)!=null&&_.length&&(f<0||f>=((v=a.value)==null?void 0:v.length))&&(r.value=c)});function h(){var f;((f=u.value)==null?void 0:f.children[r.value]).scrollIntoView({behavior:"smooth",block:"nearest"})}function g(){var c;((c=u.value)==null?void 0:c.children[r.value]).dispatchEvent(new Event("click"))}return(f,c)=>{const _=Nt,v=ie,p=Qt;return M(),E("div",ve,[L(ct,null,{default:F(()=>[f.isOpening?(M(),E("div",{key:0,id:"z-search-bgmask",onClick:c[0]||(c[0]=x=>w(e).toggle("search"))})):A("",!0)]),_:1}),L(ct,{name:"float-in"},{default:F(()=>[f.isOpening?(M(),E("div",ye,[N("form",{class:$t(["input",{searching:w(m)==="pending"}]),onSubmit:c[5]||(c[5]=q(()=>{},["prevent"]))},[L(_,{name:"ph:magnifying-glass-bold"}),Rt(N("input",{ref_key:"searchInput",ref:i,"onUpdate:modelValue":c[1]||(c[1]=x=>jt(o)?o.value=x:null),class:"search-input",placeholder:"键入开始搜索",onKeydown:[c[2]||(c[2]=ut(q(()=>{},["prevent"]),["up"])),c[3]||(c[3]=ut(q(()=>{},["prevent"]),["down"]))]},null,544),[[Pt,w(o)]]),w(o)?(M(),W(_,{key:0,class:"close",name:"ph:x-bold",onClick:c[4]||(c[4]=x=>o.value="")})):A("",!0)],34),L(Wt,{name:"expand"},{default:F(()=>{var x,T,y;return[w(o)&&w(m)==="success"&&!((x=w(a))!=null&&x.length)?(M(),E("div",Se," 无结果 ")):A("",!0),w(o)&&((T=w(a))!=null&&T.length)?(M(),E("ol",be,[(M(!0),E(Jt,null,Ut(w(a),(b,I)=>(M(),W(v,qt({key:b.id,ref_for:!0},b,{class:{active:w(r)===I},onClick:c[6]||(c[6]=R=>w(e).toggle("search")),onMouseover:R=>r.value=I}),null,16,["class","onMouseover"]))),128))],512)):A("",!0),w(o)&&((y=w(a))!=null&&y.length)?(M(),E("div",{key:2,class:"tip",onClick:c[10]||(c[10]=b=>{var I;return(I=w(i))==null?void 0:I.focus()})},[L(p,{code:"arrowup",onPress:c[7]||(c[7]=b=>(r.value--,h()))},{default:F(()=>c[11]||(c[11]=[C(" ↑ ")])),_:1}),c[15]||(c[15]=C()),L(p,{code:"arrowdown",onPress:c[8]||(c[8]=b=>(r.value++,h()))},{default:F(()=>c[12]||(c[12]=[C(" ↓ ")])),_:1}),c[16]||(c[16]=C(" 切换  ")),L(p,{code:"enter",onPress:g},{default:F(()=>c[13]||(c[13]=[C(" Enter ")])),_:1}),c[17]||(c[17]=C(" 选择  ")),L(p,{code:"escape",onPress:c[9]||(c[9]=b=>w(e).toggle("search"))},{default:F(()=>c[14]||(c[14]=[C(" Esc ")])),_:1}),c[18]||(c[18]=C(" 关闭 "))])):A("",!0)]}),_:1})])):A("",!0)]),_:1})])}}}),Le=_t(Ie,[["__scopeId","data-v-3e2b4e2c"]]);export{Le as default};
